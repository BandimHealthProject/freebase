
<html>
<!--
This file is automatically generated and all changes will be overwritten














-->
	<head>
		<meta http-equiv="content-type" content="text/html; charset=UTF-8">
		<script type="text/javascript" src="/coldchain/system/js/odkCommon.js"></script>
		<script type="text/javascript" src="/coldchain/system/js/odkData.js"></script>
		<script type="text/javascript" src="/coldchain/system/tables/js/odkTables.js"></script>
		<script type="text/javascript" src="formgen_common.js"></script>
		<script type="text/javascript" src="generate_common.js"></script>
		<link href="generate_detail.css" rel="stylesheet" />
		<style>
#rest {
	display: none;
}
body {
	font-family: arial;
}
.h4-wrapper {
	margin-top: 1.5em;
	text-align: center;
	display: block;
	/* wrapper height 45px, text height 25px */
	height: 45px;
	line-height: 45px; /* TEST for vertical center */
	background: linear-gradient(indianred, lightcoral);
}
h4 {
	display: inline-block;
	height: 25px;
	margin: 0px 0px;
	color: #eeeeee;
}
.main-col-wrapper {
	background: repeating-radial-gradient(mediumaquamarine, lightseagreen, teal);
	box-shadow: 0 2px 3px rgba(0,0,0,0.12), 0 1px 2px rgba(0,0,0,0.24);
	color: white;
	border-bottom: none !important;
	margin-top: 3.5em;
	text-align: center;
	font-size: 150%;
	/*line-height: 1.5em;*/
	padding-top: 1em;
	padding-bottom: 1em;
}
@media screen and (min-width: 480px) {
	.main-col-wrapper {
		/*line-height: 4em;*/
	}
}

button {
	/*margin-top: -4em;*/
	padding: 1em 10%;
	border: 2px solid teal;
	border-radius: 10px;
	background-color: lightsegreen;
}
.li-inner {
	border-bottom: 2px solid teal
}
li {
	/*margin-top: 10px;*/
	margin-bottom: 20px;
	padding-bottom: 5px;
	break-inside: avoid-column;
	-webkit-column-break-inside: avoid;
	display: block;
}

@media screen and (min-width: 480px) {
	ul {
		columns: 2;
		-webkit-columns: 2;
	}
}
ul {
	list-style-type: none;
	padding-left: 20px;
	padding-right: 20px;
}
.main-col-wrapper > div {
	border-bottom-style: none;
}
#edit {
	margin-left: 8px;
}
#main-col {
	display: none;
}

		</style>
		<script>
// A map of table ids to their instance columns (or _id if we couldn't pull it)
var display_cols = {"refrigerators": "refrigerator_id", "health_facility": "facility_name", "m_logs": "date_serviced", "refrigerator_types": "model_id"}
// List of tables to edit with formgen. If a table isn't found in this list, we edit it with survey instead
var allowed_tables = ["refrigerators", "health_facility", "m_logs", "refrigerator_types"];
var customJsOl = function customJsOl() {
	var generic_callback = function generic_callback(e, c, d, which, pretty, optional_col_name) {
	if (optional_col_name == null || optional_col_name == undefined || typeof(optional_col_name) != "string") {
		optional_col_name = displayCol(which, d.getMetadata(), d.getTableId());
	} else {
		optional_col_name = _tu(optional_col_name);
	}
	wrapper = function(i) { return _tc(d, which, i); };
	if (pretty) wrapper = function(i) { return window.pretty(_tc(d, which, i.toString())); };
	if (c == null) c = "null"; // because null.toString() will throw an exception
	document.getElementById("inject-" + which).innerHTML = "<b>" + optional_col_name + "</b>: " + wrapper(c);
	document.getElementById("inject-" + which).classList.add("li-inner");
}
var build_generic_callback = function build_generic_callback(which, pretty, optional_col_name) {
	return function _generic_callback_wrapper(e, c, d) {
		if (typeof(pretty) == "string") {
			c = c + pretty;
			pretty = false;
		}
		if (typeof(pretty) == "function") {
			c = pretty(c)
			pretty = false;
		}
		return generic_callback(e, c, d, which, pretty, optional_col_name);
	}
}
allowed_tables = [];


	main_col = "";
	global_which_cols_to_select = "*, (SELECT COUNT(*) FROM refrigerators WHERE facility_row_id = health_facility._id) as refrig_with_this_hfid_count"
	var fname_callback = function fname_callback(e, c, d) {
		generic_callback(e, c, d, "facility_name", true, "Health Facility ID");
		document.getElementById("refrigerator_inventory").innerHTML = _tu("Refrigerator Inventory (<span id='refrig_with_this_hfid_count'>Loading...</span>)")
		document.getElementById("refrigerator_inventory").disabled = false;
		document.getElementById("refrigerator_inventory").addEventListener("click", function click() {
			odkTables.launchHTML(null, "config/assets/aa_refrigerators_list.html#refrigerators/health_facility.facility_name = ?/" + d.getData(0, "facility_name"));
		});
		document.getElementById("refrig_with_this_hfid_count").innerText = d.getData(0, "refrig_with_this_hfid_count");
		document.getElementById("addref").addEventListener("click", function() {
			var defaults = {"facility_row_id": d.getData(0, "_id")}; // TODO - Get admin region information in there too
			defaults["regionLevel1"] = d.getData(0, "regionLevel1");
			defaults["regionLevel2"] = d.getData(0, "regionLevel2");
			defaults["adminRegion"] = d.getData(0, "admin_region");
			if (allowed_tables.indexOf("refrigerators") >= 0) {
				var id = newGuid();
				odkData.addRow("m_logs", defaults, id, function() {
					// Escape the LIMIT 1
					odkData.arbitraryQuery("m_logs", "UPDATE m_logs SET _savepoint_type = ? WHERE _id = ?;--", ["INCOMPLETE", id], 100, 0, function success(d) {
						odkTables.launchHTML({}, "config/assets/formgen/refrigerators#" + id);
					}, null);
				});
			} else {
				odkTables.addRowWithSurvey({}, "m_logs", "m_logs", null, defaults);
			}
		});
	}
	colmap = [
		['facility_name', fname_callback],
		['facility_id', build_generic_callback("facility_id", true, "Health Facility ID")],
		['facility_type', build_generic_callback("facility_type", true)],
		['facility_ownership', build_generic_callback("facility_ownership", true, "Ownership")],
		['facility_population', build_generic_callback("facility_population", true, "Population")],
		['facility_coverage', build_generic_callback("facility_coverage", "%", "Coverage")],
		['admin_region', build_generic_callback("admin_region", true, "Admin Region")],
		['electricity_source', build_generic_callback("electricity_source", true)],
		['grid_power_availability', build_generic_callback("grid_power_availability", true, "Grid Availability")],
		['gas_availability', build_generic_callback("gas_availability", true)],
		['kerosene_availability', build_generic_callback("kerosene_availability", true)],
		['solar_suitable_climate', build_generic_callback("solar_suitable_climate", true, "Solar Suitable Climate?")],
		['solar_suitable_site', build_generic_callback("solar_suitable_site", true, "Solar Suitable Site?")],
		['Location_latitude', build_generic_callback("Location_latitude", true, "Latitude (GPS)")],
		['Location_longitude', build_generic_callback("Location_longitude", true, "Longitude (GPS)")],
		['climate_zone', build_generic_callback("climate_zone", true, "Climate")],
		['distance_to_supply', build_generic_callback("distance_to_supply", true, "Distance to Supply Point")],
		['vaccine_supply_interval', build_generic_callback("vaccine_supply_interval", true)],
		['vaccine_reserve_stock_requirement', build_generic_callback("vaccine_reserve_stock_requirement", true, "Vaccine Reserve Stock Req")],
		['vaccine_supply_mode', build_generic_callback("vaccine_supply_mode", true)],
	]
	document.getElementById("bfi").innerText = _tu("Basic Facility Information");
	document.getElementById("pi").innerText = _tu("Power Information");
	document.getElementById("locationi").innerText = _tu("Location Information");
	document.getElementById("stocki").innerText = _tu("Stock Information");
	document.getElementById("addref").innerText = _tu("Add Refrigerator");

}

		</script>
		<script type="text/javascript" src="generate_detail.js"></script>
	</head>
	<body onLoad='ol();'>
		<div id="header">
			<button id="back" onClick='odkCommon.closeWindow();'></button>
			<button id="delete" onClick='_delete();' disabled></button>
			<button id="edit" onClick='edit();' disabled></button>
			<span id="main-col"></span>
		</div>
		<ul id="rest">Loading...</ul>

	<div class="main-col-wrapper">
		<div id="inject-facility_name">Loading...</div>
	</div>
	<div class="h4-wrapper"><h4 id="bfi"></h4></div>
	<ul>
		<li id='inject-facility_id'></li>
		<li id='inject-facility_type'></li>
		<li id='inject-facility_ownership'></li>
		<li id='inject-facility_population'></li>
		<li id='inject-facility_coverage'></li>
		<li id='inject-admin_region'></li>
	</ul>
	<div class="h4-wrapper"><h4 id="pi"></h4></div>
	<ul>
		<li id='inject-electricity_source'></li>
		<li id='inject-grid_power_availability'></li>
		<li id='inject-gas_availability'></li>
		<li id='inject-kerosene_availability'></li>
		<li id='inject-solar_suitable_climate'></li>
		<li id='inject-solar_suitable_site'></li>
	</ul>
	<div class="h4-wrapper"><h4 id="locationi"></h4></div>
	<ul>
		<li id='inject-Location_latitude'></li>
		<li id='inject-Location_longitude'></li>
		<li id='inject-climate_zone'></li>
	</ul>
	<div class="h4-wrapper"><h4 id="stocki"></h4></div>
	<ul>
		<li id='inject-distance_to_supply'></li>
		<li id='inject-vaccine_supply_interval'></li>
		<li id='inject-vaccine_reserve_stock_requirement'></li>
		<li id='inject-vaccine_supply_mode'></li>
	</ul>
	<div style="text-align: center;">
		<button disabled id='refrigerator_inventory'>Loading...</button>
		<br />
		<button id="addref"></button>
	</div>
		
	</body>
</html>